<div class="row">
    <h2 class="row-seperator-header">
        <i class="fa fa-search"></i> Content Search Tool
    </h2>
    <article class="col-md-12">
        <div class="jarviswidget well" id="wid-id-3" data-widget-colorbutton="false" data-widget-editbutton="false" data-widget-togglebutton="false" data-widget-deletebutton="false" data-widget-fullscreenbutton="false" data-widget-custombutton="false" data-widget-sortable="false">
            <header>
                <span class="widget-icon">
                    <i class="fa fa-comments"></i>
                </span>
            </header>
            <div>
                <div class="widget-body">

                    <div class="input-group input-group-lg hidden-mobile">
                        <input class="form-control input-lg" type="text" placeholder="Search website content..." id="websiteUrl">
                        <div class="input-group-btn">
                            <button type="button" id="searchContent" class="btn btn-default">
                                &nbsp;&nbsp;&nbsp;<i class="fa fa-fw fa-search fa-lg"></i>&nbsp;&nbsp;&nbsp;
                            </button>
                        </div>
                    </div>
                    <hr class="simple">

                    <ul id="myTab1" class="nav nav-tabs bordered">
                        <li class="active">
                            <a href="#s1" data-toggle="tab"><i class="fa fa-fw fa-lg fa-image"></i> Images</a>
                        </li>
                        <li>
                            <a href="#s2" data-toggle="tab"><i class="fa fa-fw fa-lg fa-area-chart"></i> Top Keywords</a>
                        </li>
                    </ul>

                    <div id="myTabContent1" class="tab-content padding-10">
                        <div class="tab-pane fade in active" id="s1">
                            <p>
                                <div class="lightBoxGallery">
                                    <div id="webImages" class="lightBoxGallery">

                                    </div>
                                    <div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls">
                                        <div class="slides"></div>
                                        <h3 class="title"></h3>
                                        <a class="prev">‹</a>
                                        <a class="next">›</a>
                                        <a class="close">×</a>
                                        <a class="play-pause"></a>
                                        <ol class="indicator"></ol>
                                    </div>

                                </div>
                            </p>
                        </div>
                        <div class="tab-pane fade" id="s2">
                            <p>
                                <section id="widget-grid" class="">
                                    <div class="row">
                                        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                            <div class="jarviswidget" id="wid-id-4" data-widget-editbutton="false">
                                                <header>
                                                    <span class="widget-icon">
                                                        <i class="fa fa-bar-chart-o"></i>
                                                    </span>
                                                    <h2>Sales Chart</h2>
                                                </header>
                                                <div>
                                                    <div class="jarviswidget-editbox">
                                                    </div>
                                                    <div class="widget-body no-padding">
                                                        <div id="saleschart" class="chart" style="width:100%;height:350px;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </article>
                                    </div>
                                </section>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>
</div>

@section Scripts {
    <script src="~/js/plugin/blueimp/jquery.blueimp-gallery.min.js"></script>

    <script>

        function isValidURL(str) {
            return str !== undefined && (str.indexOf("http://") != -1 || str.indexOf("https://") != -1);
        }

        $("#searchContent").click(function () {

            var requestWebUrl = $('#websiteUrl').val();
            var dataObject = {
                'url': requestWebUrl
            };

            $.ajax({
                type: "POST",
                url: "http://localhost:49756/api/content/search",
                dataType: 'json',
                data: dataObject,
                success: function (response) {
                    //console.log(response.images);

                    var htmlString = "";
                    //<a href='img/gallery/1.jpg' title='Image from Unsplash' data-gallery=""><img src='img/gallery/1s.jpg'></a>
                    $.each(response.images, function (i, item) {
                        if (!isValidURL(item)) {
                            item = requestWebUrl + item;
                            console.log(item);
                        }
                        imageUrl = item
                        htmlString += "<a href='" + item + "' data-gallery=''><img style='margin: 5px;' src='" + item + "' height='100px' width='100px'></a>";
                    });

                    $('#webImages').html(htmlString + "");
                },
                fail: function (error) {
                    console.log(error);
                }
            });
        });
    </script>

    <script type="text/javascript">


        var plot_1;

        pageSetUp();

        // PAGE RELATED SCRIPTS

        var pagefunction = function () {

            /* chart colors default */
            var $chrt_border_color = "#efefef";
            var $chrt_grid_color = "#DDD";
            var $chrt_main = "#E24913"; /* red       */
            var $chrt_second = "#6595b4"; /* blue      */
            var $chrt_third = "#FF9F01"; /* orange    */
            var $chrt_fourth = "#7e9d3a"; /* green     */
            var $chrt_fifth = "#BD362F"; /* dark red  */
            var $chrt_mono = "#000";

            /* sales chart */

            if ($("#saleschart").length) {

                var data = [["January", 10], ["February", 8], ["March", 4], ["April", 13], ["May", 17], ["June", 9]];

                $.plot("#saleschart", [data], {
                    series: {
                        bars: {
                            show: true,
                            barWidth: 0.6,
                            align: "center"
                        }
                    },
                    xaxis: {
                        mode: "categories",
                        tickLength: 0
                    }
                });
                $('#saleschart').removeAttr("style");
                $('#saleschart').attr("style", "padding:12px;");
                /*var d = [
                    [1196463600000, 0], [1196550000000, 0], [1196636400000, 0], [1196722800000, 77],
                    [1196809200000, 3636], [1196895600000, 3575], [1196982000000, 2736], [1197068400000, 1086],
                    [1197154800000, 676], [1197241200000, 1205], [1197327600000, 906], [1197414000000, 710],
                    [1197500400000, 639], [1197586800000, 540], [1197673200000, 435], [1197759600000, 301],
                    [1197846000000, 575], [1197932400000, 481], [1198018800000, 591], [1198105200000, 608],
                    [1198191600000, 459], [1198278000000, 234], [1198364400000, 1352], [1198450800000, 686],
                    [1198537200000, 279], [1198623600000, 449], [1198710000000, 468], [1198796400000, 392],
                    [1198882800000, 282], [1198969200000, 208], [1199055600000, 229], [1199142000000, 177],
                    [1199228400000, 374], [1199314800000, 436], [1199401200000, 404], [1199487600000, 253],
                    [1199574000000, 218], [1199660400000, 476], [1199746800000, 462], [1199833200000, 500],
                    [1199919600000, 700], [1200006000000, 750], [1200092400000, 600], [1200178800000, 500],
                    [1200265200000, 900], [1200351600000, 930], [1200438000000, 1200], [1200524400000, 980],
                    [1200610800000, 950], [1200697200000, 900], [1200783600000, 1000], [1200870000000, 1050],
                    [1200956400000, 1150], [1201042800000, 1100], [1201129200000, 1200], [1201215600000, 1300],
                    [1201302000000, 1700], [1201388400000, 1450], [1201474800000, 1500], [1201561200000, 546],
                    [1201647600000, 614], [1201734000000, 954], [1201820400000, 1700], [1201906800000, 1800],
                    [1201993200000, 1900], [1202079600000, 2000], [1202166000000, 2100], [1202252400000, 2200],
                    [1202338800000, 2300], [1202425200000, 2400], [1202511600000, 2550], [1202598000000, 2600],
                    [1202684400000, 2500], [1202770800000, 2700], [1202857200000, 2750], [1202943600000, 2800],
                    [1203030000000, 3245], [1203116400000, 3345], [1203202800000, 3000], [1203289200000, 3200],
                    [1203375600000, 3300], [1203462000000, 3400], [1203548400000, 3600], [1203634800000, 3700],
                    [1203721200000, 3800], [1203807600000, 4000], [1203894000000, 4500]
                ];*/

                //for (var i = 0; i < d.length; ++i)
                //    d[i][0] += 60 * 60 * 1000;


                /*var options = {
                    xaxis: {
                        mode: "categories",
                        tickLength: 5
                    },
                    series: {
                        lines: {
                            show: true,
                            lineWidth: 1,
                            fill: true,
                            fillColor: {
                                colors: [
                                    {
                                        opacity: 0.1
                                    }, {
                                        opacity: 0.15
                                    }
                                ]
                            }
                        },
                        points: { show: true },
                        shadowSize: 0
                    },
                    selection: {
                        mode: "x"
                    },
                    grid: {
                        hoverable: true,
                        clickable: true,
                        tickColor: $chrt_border_color,
                        borderWidth: 0,
                        borderColor: $chrt_border_color,
                    },
                    tooltip: true,
                    tooltipOpts: {
                        content: "Your sales for <b>%x</b> was <span>$%y</span>",
                        dateFormat: "%y-%0m-%0d",
                        defaultTheme: false
                    },
                    colors: [$chrt_second],
                };
                plot_1 = $.plot($("#saleschart"), [d], options);*/
            };

            /* end sales chart */
        };

        // destroy generated instances
        // pagedestroy is called automatically before loading a new page
        // only usable in AJAX version!

        var pagedestroy = function () {

            //destroy flots
            plot_1.shutdown();
            plot_1 = null;
        };

        // end destroy

        // end pagefunction

        // load all flot plugins
        loadScript("/js/plugin/flot/jquery.flot.cust.min.js",
            function () {
                loadScript("/js/plugin/flot/jquery.flot.resize.min.js",
                    function () {
                        loadScript("/js/plugin/flot/jquery.flot.fillbetween.min.js",
                            function () {
                                loadScript("/js/plugin/flot/jquery.flot.orderBar.min.js",
                                    function () {
                                        loadScript("/js/plugin/flot/jquery.flot.categories.min.js",
                                            function () {
                                                loadScript("/js/plugin/flot/jquery.flot.time.min.js",
                                                    function () {
                                                        loadScript("/js/plugin/flot/jquery.flot.tooltip.min.js",
                                                            pagefunction);
                                                    });
                                            });
                                    });
                            });
                    });
            });

    </script>
}
